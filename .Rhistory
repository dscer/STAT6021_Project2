1-pchisq(deltaG2,3)
preds<-predict(result,newdata=test, type="response")
rates<-prediction(preds, test$waterfront)
roc_result<-performance(rates,measure="tpr", x.measure="fpr")
plot(roc_result, main="ROC Curve for Waterfront", colorize=TRUE)
lines(x = c(0,1), y = c(0,1), col="red")
auc<-performance(rates, measure = "auc")
auc@y.values
table(test$waterfront, preds>0.8)
res <- round(preds, 4)
#res
plot(res)
table_mat <- table(test$waterfront, preds>0.5)
table_mat
FPR <- round(4/(4285+4), 4)
paste0('The FPR is: ', FPR)
FNR <- round(29/(29+5),4)
paste0('The FNR is: ', FNR)
err <- round((29+4)/(4285+4+29+5),4)
paste0('The Error Rate is: ', err)
precision <- function(matrix) {
# True positive
tp <- matrix[2, 2]
# false positive
fp <- matrix[1, 2]
return (tp / (tp + fp))
}
recall <- function(matrix) {
# true positive
tp <- matrix[2, 2]# false positive
fn <- matrix[2, 1]
return (tp / (tp + fn))
}
prec <- precision(table_mat)
paste0("Precision: ", round(prec, 4))
rec <- recall(table_mat)
paste0("Recall: ", round(rec, 4))
f1 <- 2 * ((prec * rec) / (prec + rec))
f1
newdata<-data.frame(price=650000, bedrooms=3, sqft_living=3000)
##log odds
predict(reduced,newdata)
##odds
odds<-exp(predict(reduced,newdata))
odds
##convert odds to probability
prob<-odds/(1+odds)
prob
dn1<-ggplot(train, aes(x=price, color=waterfront))+
geom_density()+
labs(x="waterfront", y="price", title="Price by Waterfront")
dn2<-ggplot(train, aes(x=bedrooms, color=waterfront))+
geom_density()+
labs(x="waterfront", y="bedrooms", title="Bedrooms by Waterfront")
dn3<-ggplot(train, aes(x=bathrooms, color=waterfront))+
geom_density()+
labs(x="waterfront", y="bathrooms", title="Bathrooms by Waterfront")
dn4<-ggplot(train, aes(x=sqft_living, color=waterfront))+
geom_density()+
labs(x="waterfront", y="sqft_living", title="Sqft Living by Waterfront")
dn5<-ggplot(train, aes(x=sqft_lot, color=waterfront))+
geom_density()+
labs(x="waterfront", y="sqft_lot", title="Sqft Lotby Waterfront")
dn6<-ggplot(train, aes(x=floors, color=waterfront))+
geom_density()+
labs(x="waterfront", y="floors", title="Floor by Waterfront")
dn7<-ggplot(train, aes(x=view, color=waterfront))+
geom_density()+
labs(x="waterfront", y="sqft_lot", title="Sqft Lotby Waterfront")
dn8<-ggplot(train, aes(x=condition, color=waterfront))+
geom_density()+
labs(x="waterfront", y="floors", title="Floor by Waterfront")
grid.arrange(dn1, dn2, dn3, dn4, dn5, dn6, dn7, dn8, ncol = 2, nrow = 4)
dn1<-ggplot(df, aes(x=price, color=waterfront))+
geom_density()+
labs(x="waterfront", y="price", title="Price by Waterfront")
dn2<-ggplot(df, aes(x=bedrooms, color=waterfront))+
geom_density()+
labs(x="waterfront", y="bedrooms", title="Bedrooms by Waterfront")
dn3<-ggplot(df, aes(x=bathrooms, color=waterfront))+
geom_density()+
labs(x="waterfront", y="bathrooms", title="Bathrooms by Waterfront")
dn4<-ggplot(df, aes(x=sqft_living, color=waterfront))+
geom_density()+
labs(x="waterfront", y="sqft_living", title="Sqft Living by Waterfront")
dn5<-ggplot(df, aes(x=sqft_lot, color=waterfront))+
geom_density()+
labs(x="waterfront", y="sqft_lot", title="Sqft Lotby Waterfront")
dn6<-ggplot(df, aes(x=floors, color=waterfront))+
geom_density()+
labs(x="waterfront", y="floors", title="Floor by Waterfront")
dn7<-ggplot(df, aes(x=view, color=waterfront))+
geom_density()+
labs(x="waterfront", y="sqft_lot", title="Sqft Lotby Waterfront")
dn8<-ggplot(df, aes(x=condition, color=waterfront))+
geom_density()+
labs(x="waterfront", y="floors", title="Floor by Waterfront")
grid.arrange(dn1, dn2, dn3, dn4, dn5, dn6, dn7, dn8, ncol = 2, nrow = 4)
dn1<-ggplot(df, aes(x=price, color=waterfront))+
geom_density()+
labs(x="waterfront", y="price", title="Price by Waterfront")
dn2<-ggplot(df, aes(x=bedrooms, color=waterfront))+
geom_density()+
labs(x="waterfront", y="bedrooms", title="Bedrooms by Waterfront")
dn3<-ggplot(df, aes(x=bathrooms, color=waterfront))+
geom_density()+
labs(x="waterfront", y="bathrooms", title="Bathrooms by Waterfront")
dn4<-ggplot(df, aes(x=sqft_living, color=waterfront))+
geom_density()+
labs(x="waterfront", y="sqft_living", title="Sqft Living by Waterfront")
dn5<-ggplot(df, aes(x=sqft_lot, color=waterfront))+
geom_density()+
labs(x="waterfront", y="sqft_lot", title="Sqft Lot by Waterfront")
dn6<-ggplot(df, aes(x=floors, color=waterfront))+
geom_density()+
labs(x="waterfront", y="floors", title="Floor by Waterfront")
dn7<-ggplot(df, aes(x=view, color=waterfront))+
geom_density()+
labs(x="waterfront", y="view", title="View by Waterfront")
dn8<-ggplot(df, aes(x=condition, color=waterfront))+
geom_density()+
labs(x="waterfront", y="condition", title="Condition by Waterfront")
grid.arrange(dn1, dn2, dn3, dn4, dn5, dn6, dn7, dn8, ncol = 2, nrow = 4)
ggplot(df, aes(x=condition, color=waterfront))+
geom_density()+
labs(x="waterfront", y="condition", title="Condition by Waterfront")
df <- read.csv('.//data//kc_house_data.csv', header = T)
df$waterfront <- as.factor(df$waterfront)
df$condition <- as.factor(df$condition)
df$view <- as.factor(df$view)
df$condition
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = TRUE)
library(tidyverse)
library(gridExtra)
library(ROCR)
library(leaps)
set.seed(1)
df <- read.csv('.//data//kc_house_data.csv', header = T)
df$waterfront <- as.factor(df$waterfront)
df$condition <- as.factor(df$condition)
df$view <- as.factor(df$view)
mytab<-table(df$waterfront, df$view)
mytab
prop.table(mytab, 1)
mytab<-table(df$waterfront, df$condition)
mytab
prop.table(mytab, 1)
dn1<-ggplot(df, aes(x=price, color=waterfront))+
geom_density()+
labs(x="waterfront", y="price", title="Price by Waterfront")
dn2<-ggplot(df, aes(x=bedrooms, color=waterfront))+
geom_density()+
labs(x="waterfront", y="bedrooms", title="Bedrooms by Waterfront")
dn3<-ggplot(df, aes(x=bathrooms, color=waterfront))+
geom_density()+
labs(x="waterfront", y="bathrooms", title="Bathrooms by Waterfront")
dn4<-ggplot(df, aes(x=sqft_living, color=waterfront))+
geom_density()+
labs(x="waterfront", y="sqft_living", title="Sqft Living by Waterfront")
dn5<-ggplot(df, aes(x=sqft_lot, color=waterfront))+
geom_density()+
labs(x="waterfront", y="sqft_lot", title="Sqft Lot by Waterfront")
dn6<-ggplot(df, aes(x=floors, color=waterfront))+
geom_density()+
labs(x="waterfront", y="floors", title="Floor by Waterfront")
dn7<-ggplot(df, aes(x=view, color=waterfront))+
geom_density()+
labs(x="waterfront", y="view", title="View by Waterfront")
dn8<-ggplot(df, aes(x=condition, color=waterfront))+
geom_density()+
labs(x="waterfront", y="condition", title="Condition by Waterfront")
grid.arrange(dn1, dn2, dn3, dn4, dn5, dn6, dn7, dn8, ncol = 2, nrow = 4)
bp1<-ggplot(train, aes(x=waterfront, y=price))+
geom_boxplot()+
labs(x="waterfront", y="price", title="Price by Waterfront")
bp2<-ggplot(train, aes(x=waterfront, y=bedrooms))+
geom_boxplot()+
labs(x="waterfront", y="bedrooms", title="Bedrooms by Waterfront")
bp3<-ggplot(train, aes(x=waterfront, y=bathrooms))+
geom_boxplot()+
labs(x="waterfront", y="bathrooms", title="Bathrooms by Waterfront")
bp4<-ggplot(train, aes(x=waterfront, y=sqft_living))+
geom_boxplot()+
labs(x="waterfront", y="sqft_living", title="Sqft Living by Waterfront")
bp5<-ggplot(train, aes(x=waterfront, y=sqft_lot))+
geom_boxplot()+
labs(x="waterfront", y="sqft_lot", title="Sqft Lotby Waterfront")
bp6<-ggplot(train, aes(x=waterfront, y=floors))+
geom_boxplot()+
labs(x="waterfront", y="floors", title="Floor by Waterfront")
grid.arrange(bp1, bp2, bp3, bp4, bp5, bp6, ncol = 2, nrow = 3)
Data <- df %>%
select(-c(1,2,10,12,13,14,15,16,17,18,19,20,21)) %>%
drop_na()
sample<-sample.int(nrow(Data), floor(.80*nrow(Data)), replace = F)
train<-Data[sample, ]
test<-Data[-sample, ]
allreg2 <- regsubsets(waterfront ~., data=Data, nbest=2)
summary(allreg2)
coef(allreg2, which.max(summary(allreg2)$adjr2))
coef(allreg2, which.min(summary(allreg2)$cp))
coef(allreg2, which.min(summary(allreg2)$bic))
result<-glm(waterfront~price+bedrooms+sqft_living+sqft_lot+floors+condition, family="binomial", data=train)
summary(result)
reduced<-glm(waterfront~price+bedrooms+sqft_living, family="binomial", data=train)
summary(reduced)
deltaG2<-reduced$null.deviance-reduced$deviance
deltaG2
1-pchisq(deltaG2,3)
preds<-predict(result,newdata=test, type="response")
rates<-prediction(preds, test$waterfront)
roc_result<-performance(rates,measure="tpr", x.measure="fpr")
plot(roc_result, main="ROC Curve for Waterfront", colorize=TRUE)
lines(x = c(0,1), y = c(0,1), col="red")
auc<-performance(rates, measure = "auc")
auc@y.values
table(test$waterfront, preds>0.8)
res <- round(preds, 4)
#res
plot(res)
table_mat <- table(test$waterfront, preds>0.5)
table_mat
FPR <- round(4/(4285+4), 4)
paste0('The FPR is: ', FPR)
FNR <- round(29/(29+5),4)
paste0('The FNR is: ', FNR)
err <- round((29+4)/(4285+4+29+5),4)
paste0('The Error Rate is: ', err)
precision <- function(matrix) {
# True positive
tp <- matrix[2, 2]
# false positive
fp <- matrix[1, 2]
return (tp / (tp + fp))
}
recall <- function(matrix) {
# true positive
tp <- matrix[2, 2]# false positive
fn <- matrix[2, 1]
return (tp / (tp + fn))
}
prec <- precision(table_mat)
paste0("Precision: ", round(prec, 4))
rec <- recall(table_mat)
paste0("Recall: ", round(rec, 4))
f1 <- 2 * ((prec * rec) / (prec + rec))
f1
newdata<-data.frame(price=650000, bedrooms=3, sqft_living=3000)
##log odds
predict(reduced,newdata)
##odds
odds<-exp(predict(reduced,newdata))
odds
##convert odds to probability
prob<-odds/(1+odds)
prob
dn8
dn1<-ggplot(df, aes(x=price, color=waterfront))+
geom_density()+
labs(x="waterfront", y="price", title="Price by Waterfront")
dn2<-ggplot(df, aes(x=bedrooms, color=waterfront))+
geom_density()+
labs(x="waterfront", y="bedrooms", title="Bedrooms by Waterfront")
dn3<-ggplot(df, aes(x=bathrooms, color=waterfront))+
geom_density()+
labs(x="waterfront", y="bathrooms", title="Bathrooms by Waterfront")
dn4<-ggplot(df, aes(x=sqft_living, color=waterfront))+
geom_density()+
labs(x="waterfront", y="sqft_living", title="Sqft Living by Waterfront")
dn5<-ggplot(df, aes(x=sqft_lot, color=waterfront))+
geom_density()+
labs(x="waterfront", y="sqft_lot", title="Sqft Lot by Waterfront")
dn6<-ggplot(df, aes(x=floors, color=waterfront))+
geom_density()+
labs(x="waterfront", y="floors", title="Floor by Waterfront")
dn7<-ggplot(df, aes(x=view, color=waterfront))+
geom_density()+
labs(x="waterfront", y="view", title="View by Waterfront")
dn8<-ggplot(df, aes(x=condition, color=waterfront))+
geom_density()+
labs(x="waterfront", y="condition", title="Condition by Waterfront")
grid.arrange(dn1, dn2, dn3, dn4, dn5, dn6, dn7, dn8, ncol = 2, nrow = 4)
df <- read.csv('.//data//kc_house_data.csv', header = T)
df$waterfront <- as.factor(df$waterfront)
#df$condition <- as.factor(df$condition)
#df$view <- as.factor(df$view)
dn1<-ggplot(df, aes(x=price, color=waterfront))+
geom_density()+
labs(x="waterfront", y="price", title="Price by Waterfront")
dn2<-ggplot(df, aes(x=bedrooms, color=waterfront))+
geom_density()+
labs(x="waterfront", y="bedrooms", title="Bedrooms by Waterfront")
dn3<-ggplot(df, aes(x=bathrooms, color=waterfront))+
geom_density()+
labs(x="waterfront", y="bathrooms", title="Bathrooms by Waterfront")
dn4<-ggplot(df, aes(x=sqft_living, color=waterfront))+
geom_density()+
labs(x="waterfront", y="sqft_living", title="Sqft Living by Waterfront")
dn5<-ggplot(df, aes(x=sqft_lot, color=waterfront))+
geom_density()+
labs(x="waterfront", y="sqft_lot", title="Sqft Lot by Waterfront")
dn6<-ggplot(df, aes(x=floors, color=waterfront))+
geom_density()+
labs(x="waterfront", y="floors", title="Floor by Waterfront")
dn7<-ggplot(df, aes(x=view, color=waterfront))+
geom_density()+
labs(x="waterfront", y="view", title="View by Waterfront")
dn8<-ggplot(df, aes(x=condition, color=waterfront))+
geom_density()+
labs(x="waterfront", y="condition", title="Condition by Waterfront")
grid.arrange(dn1, dn2, dn3, dn4, dn5, dn6, dn7, dn8, ncol = 2, nrow = 4)
bp1<-ggplot(train, aes(x=waterfront, y=price))+
geom_boxplot()+
labs(x="waterfront", y="price", title="Price by Waterfront")
bp2<-ggplot(train, aes(x=waterfront, y=bedrooms))+
geom_boxplot()+
labs(x="waterfront", y="bedrooms", title="Bedrooms by Waterfront")
bp3<-ggplot(train, aes(x=waterfront, y=bathrooms))+
geom_boxplot()+
labs(x="waterfront", y="bathrooms", title="Bathrooms by Waterfront")
bp4<-ggplot(train, aes(x=waterfront, y=sqft_living))+
geom_boxplot()+
labs(x="waterfront", y="sqft_living", title="Sqft Living by Waterfront")
bp5<-ggplot(train, aes(x=waterfront, y=sqft_lot))+
geom_boxplot()+
labs(x="waterfront", y="sqft_lot", title="Sqft Lotby Waterfront")
bp6<-ggplot(train, aes(x=waterfront, y=floors))+
geom_boxplot()+
labs(x="waterfront", y="floors", title="Floor by Waterfront")
grid.arrange(bp1, bp2, bp3, bp4, bp5, bp6, ncol = 2, nrow = 3)
allreg2 <- regsubsets(waterfront ~., data=df, nbest=2)
allreg2 <- regsubsets(waterfront ~., data=Data, nbest=2)
summary(allreg2)
coef(allreg2, which.max(summary(allreg2)$adjr2))
coef(allreg2, which.min(summary(allreg2)$cp))
coef(allreg2, which.min(summary(allreg2)$bic))
56.77^2
58*(56.77^2)
3222.833*58
1.04^2
12.85 * 56.77^2
41413.4 * 2
82826.8 + 186924.3
41413.4 * 1
41413.4 + 186924.3
917.8870 - 0.35
917.537/9.6435
917.8870/9.6435
2×(1−pt(95.14564, 58))
2*(1−pt(95.14564, 58))
qt(0.975, 58)
917.8870 +  0.4179(60)
917.8870 +  (0.4179 * 60)
1/(1+43)
9 / (9+6)
6+43
6+43+1+9
49/59
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ROCR)
library(palmerpenguins)
library(gridExtra)
set.seed(1)
Data<-penguins
##remove penguins with gender missing
Data<-Data[complete.cases(Data[ , 7]),-c(2,8)]
##80-20 split
set.seed(1)
sample<-sample.int(nrow(Data), floor(.80*nrow(Data)), replace = F)
train<-Data[sample, ]
test<-Data[-sample, ]
result<-glm(sex~species+bill_length_mm+bill_depth_mm+body_mass_g,
family="binomial", data=train)
summary(result)
preds<-predict(result,newdata=test, type="response")
rates<-prediction(preds, test$sex)
roc_result<-performance(rates,measure="tpr", x.measure="fpr")
plot(roc_result, main="ROC Curve for Titanic")
lines(x = c(0,1), y = c(0,1), col="red")
auc<-performance(rates, measure = "auc")
auc@y.values
##confusion matrix. Actual values in the rows, predicted classification in cols
table(test$sex, preds>0.5)
res <- round(preds, 4)
res
plot(res)
table(test$sex, preds>0.8)
##confusion matrix. Actual values in the rows, predicted classification in cols
table(test$sex, preds>0.8)
##confusion matrix. Actual values in the rows, predicted classification in cols
table(test$sex, preds>0.5)
##confusion matrix. Actual values in the rows, predicted classification in cols
table(test$sex, preds>0.8)
(7+4)/(31+4+7+25)
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = TRUE)
library(tidyverse)
library(gridExtra)
library(ROCR)
library(leaps)
set.seed(1)
df <- read.csv('.//data//kc_house_data.csv', header = T)
df$waterfront <- as.factor(df$waterfront)
#df$condition <- as.factor(df$condition)
#df$view <- as.factor(df$view)
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = TRUE)
library(tidyverse)
library(gridExtra)
library(ROCR)
library(leaps)
set.seed(1)
df <- read.csv('.//data//kc_house_data.csv', header = T)
df$waterfront <- as.factor(df$waterfront)
#df$condition <- as.factor(df$condition)
#df$view <- as.factor(df$view)
mytab<-table(df$waterfront, df$view)
mytab
prop.table(mytab, 1)
mytab<-table(df$waterfront, df$condition)
mytab
prop.table(mytab, 1)
dn1<-ggplot(df, aes(x=price, color=waterfront))+
geom_density()+
labs(x="waterfront", y="price", title="Price by Waterfront")
dn2<-ggplot(df, aes(x=bedrooms, color=waterfront))+
geom_density()+
labs(x="waterfront", y="bedrooms", title="Bedrooms by Waterfront")
dn3<-ggplot(df, aes(x=bathrooms, color=waterfront))+
geom_density()+
labs(x="waterfront", y="bathrooms", title="Bathrooms by Waterfront")
dn4<-ggplot(df, aes(x=sqft_living, color=waterfront))+
geom_density()+
labs(x="waterfront", y="sqft_living", title="Sqft Living by Waterfront")
dn5<-ggplot(df, aes(x=sqft_lot, color=waterfront))+
geom_density()+
labs(x="waterfront", y="sqft_lot", title="Sqft Lot by Waterfront")
dn6<-ggplot(df, aes(x=floors, color=waterfront))+
geom_density()+
labs(x="waterfront", y="floors", title="Floor by Waterfront")
dn7<-ggplot(df, aes(x=view, color=waterfront))+
geom_density()+
labs(x="waterfront", y="view", title="View by Waterfront")
dn8<-ggplot(df, aes(x=condition, color=waterfront))+
geom_density()+
labs(x="waterfront", y="condition", title="Condition by Waterfront")
grid.arrange(dn1, dn2, dn3, dn4, dn5, dn6, dn7, dn8, ncol = 2, nrow = 4)
bp1<-ggplot(train, aes(x=waterfront, y=price))+
geom_boxplot()+
labs(x="waterfront", y="price", title="Price by Waterfront")
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = TRUE)
library(tidyverse)
library(gridExtra)
library(ROCR)
library(leaps)
set.seed(1)
df <- read.csv('.//data//kc_house_data.csv', header = T)
df$waterfront <- as.factor(df$waterfront)
#df$condition <- as.factor(df$condition)
#df$view <- as.factor(df$view)
mytab<-table(df$waterfront, df$view)
mytab
prop.table(mytab, 1)
mytab<-table(df$waterfront, df$condition)
mytab
prop.table(mytab, 1)
dn1<-ggplot(df, aes(x=price, color=waterfront))+
geom_density()+
labs(x="waterfront", y="price", title="Price by Waterfront")
dn2<-ggplot(df, aes(x=bedrooms, color=waterfront))+
geom_density()+
labs(x="waterfront", y="bedrooms", title="Bedrooms by Waterfront")
dn3<-ggplot(df, aes(x=bathrooms, color=waterfront))+
geom_density()+
labs(x="waterfront", y="bathrooms", title="Bathrooms by Waterfront")
dn4<-ggplot(df, aes(x=sqft_living, color=waterfront))+
geom_density()+
labs(x="waterfront", y="sqft_living", title="Sqft Living by Waterfront")
dn5<-ggplot(df, aes(x=sqft_lot, color=waterfront))+
geom_density()+
labs(x="waterfront", y="sqft_lot", title="Sqft Lot by Waterfront")
dn6<-ggplot(df, aes(x=floors, color=waterfront))+
geom_density()+
labs(x="waterfront", y="floors", title="Floor by Waterfront")
dn7<-ggplot(df, aes(x=view, color=waterfront))+
geom_density()+
labs(x="waterfront", y="view", title="View by Waterfront")
dn8<-ggplot(df, aes(x=condition, color=waterfront))+
geom_density()+
labs(x="waterfront", y="condition", title="Condition by Waterfront")
grid.arrange(dn1, dn2, dn3, dn4, dn5, dn6, dn7, dn8, ncol = 2, nrow = 4)
bp1<-ggplot(train, aes(x=waterfront, y=price))+
geom_boxplot()+
labs(x="waterfront", y="price", title="Price by Waterfront")
bp1<-ggplot(df, aes(x=waterfront, y=price))+
geom_boxplot()+
labs(x="waterfront", y="price", title="Price by Waterfront")
bp2<-ggplot(df, aes(x=waterfront, y=bedrooms))+
geom_boxplot()+
labs(x="waterfront", y="bedrooms", title="Bedrooms by Waterfront")
bp3<-ggplot(df, aes(x=waterfront, y=bathrooms))+
geom_boxplot()+
labs(x="waterfront", y="bathrooms", title="Bathrooms by Waterfront")
bp4<-ggplot(df, aes(x=waterfront, y=sqft_living))+
geom_boxplot()+
labs(x="waterfront", y="sqft_living", title="Sqft Living by Waterfront")
bp5<-ggplot(df, aes(x=waterfront, y=sqft_lot))+
geom_boxplot()+
labs(x="waterfront", y="sqft_lot", title="Sqft Lotby Waterfront")
bp6<-ggplot(df, aes(x=waterfront, y=floors))+
geom_boxplot()+
labs(x="waterfront", y="floors", title="Floor by Waterfront")
grid.arrange(bp1, bp2, bp3, bp4, bp5, bp6, ncol = 2, nrow = 3)
